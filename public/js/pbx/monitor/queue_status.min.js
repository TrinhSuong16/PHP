/*=========================================================================================
    File Name: queue_status.js
    Description: Monitor board
    --------------------------------------------------------------------------------------
    Item Name: Vuexy  - Vuejs, HTML & Laravel Admin Dashboard Template
    Author: Lê Chí Đại
    Author Email: dai.le@southtelecom.vn
==========================================================================================*/
if(pbx.init(),$(document).ready(function(){$("#grid").kendoGrid({dataSource:[],sortable:!1,pageable:!1,filterable:!1,noRecords:!0,scrollable:!0,columns:[{field:"status",title:controlsKendo.grid.column.title.status,width:70,headerAttributes:{class:"table-header-cell",style:"text-align: center; font-size: 14px"},attributes:{class:"table-cell",style:"text-align: center;"}},{field:"data",title:controlsKendo.grid.column.title.data,headerAttributes:{class:"table-header-cell",style:"text-align: center; font-size: 14px"}},{field:"agentname",title:controlsKendo.grid.column.title.agentname,width:180,headerAttributes:{class:"table-header-cell",style:"text-align: center; font-size: 14px"}}],rowTemplate:function(e){let t=`<tr data-uid="${e.uid}"><td colspan="3">${e.data}</td></tr>`;return e.members&&e.members.forEach(e=>{let a="#fff";switch(e.agent_status){case"Invalid":case"Unavailable":a="gray";break;case"In use":a="red";break;case"Not in use":a="green",1==e.ispaused&&(a="#cccc00")}t+=`<tr>\n                                <td class="table-cell"><div style='width: 15px;background-color: ${a};height: 15px; margin: 0 auto;'></div></td>\n                                <td class="table-cell">${e.data}</td>\n                                <td class="table-cell" style="text-align: center;">${e.callername}</td>\n                            </tr>`}),t}})}),"undefined"!=typeof EventSource){var path=base_url+"monitor/queue_status/sse",es=new EventSource(path);es.addEventListener("total_in_use",e=>{$("span#overview_inuse").text(e.data)}),es.addEventListener("total_invalid",e=>{$("span#overview_invalid").text(e.data)}),es.addEventListener("total_unavailable",e=>{$("span#overview_unavailable").text(e.data)}),es.addEventListener("details",e=>{let t=new kendo.data.DataSource({data:JSON.parse(e.data)});$("#grid").data("kendoGrid").setDataSource(t)})}else alert("Sorry! No server-sent events support.."),window.location=base_url;